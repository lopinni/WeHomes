<template>
    <template if:false={loaded}>
        <lightning-spinner alternative-text="Loading"></lightning-spinner>
    </template>
    <template if:true={loaded}>
        <div class="slds-grid slds-gutters">
            <div class="slds-col slds-size_1-of-12"> </div>
            <div class="slds-col slds-size_10-of-12">
                <c-pricebook-chart pricebooks={pricebookData} onshow={handleShow}> </c-pricebook-chart>
                <div class="slds-p-top_medium">
                    <div class="slds-page-header slds-p-top_medium">
                        <div class="slds-page-header__row slds-border_bottom" style="padding-bottom: 5px;">
                            <div class="slds-page-header__col-title">
                                <div class="slds-media">
                                    <div class="slds-media__body">
                                        <div class="slds-page-header__name">
                                            <div class="slds-page-header__name-title">
                                                <h1>
                                                    <span> {label.PRICE_BOOKS} </span>
                                                    <span class="slds-page-header__title slds-truncate" title="Recently Viewed">
                                                        {label.ALL_PRICE_BOOKS}
                                                    </span>
                                                </h1>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-page-header__col-actions">
                                <div class="slds-page-header__controls">
                                    <div class="slds-page-header__control">
                                        <button class="slds-button slds-button_neutral" onclick={openNewPB}> {label.NEW} </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <lightning-datatable
                            key-field="Id"
                            data={pricebookData}
                            columns={pricebookColumns}
                            onrowaction={handleRowAction}
                            draft-values={saveDraftValues}
                            onsave={handleSave}
                            hide-checkbox-column
                        > </lightning-datatable>
                    </div>
                </div>
                <div class="slds-p-top_medium">
                    <div class="slds-page-header slds-p-top_medium">
                        <div class="slds-page-header__row slds-border_bottom" style="padding-bottom: 5px;">
                            <div class="slds-page-header__col-title">
                                <div class="slds-media">
                                    <div class="slds-media__body">
                                        <div class="slds-page-header__name">
                                            <div class="slds-page-header__name-title">
                                                <h1>
                                                    <span> {label.PRICE_BOOK_ENTRIES} </span>
                                                    <span class="slds-page-header__title slds-truncate" title="Recently Viewed">
                                                        {label.AVAILABLE_ENTRIES}
                                                    </span>
                                                </h1>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-page-header__col-actions">
                                <div class="slds-page-header__controls">
                                    <div class="slds-page-header__control">
                                        <lightning-input type="number" min="-100" max="100" step="1" variant="label-hidden"> </lightning-input>
                                    </div>
                                    <div class="slds-page-header__control">
                                        <button class="slds-button slds-button_neutral" onclick={setupDiscountModal}> {label.SET_DISCOUNT} </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <lightning-datatable
                            key-field="Id"
                            data={priceBookEntryData}
                            columns={entryColumns}
                            draft-values={entryDraftValues}
                            onsave={handleEntrySave}
                            lwc:ref="entries"
                        > </lightning-datatable>
                    </div>
                </div>
            </div>
            <div class="slds-col slds-size_1-of-12"> </div>
            <c-pricebook-modal 
                show={openNewPBModal} 
                onclose={closeNewPB} 
                onrefresh={refreshPricebooks}
            ></c-pricebook-modal>
            <c-add-product-modal 
                product-data={products}
                show={openAddProductModal} 
                onclose={closeAddProduct} 
                price-book-id={priceBookToAdd}
                onsuccess={closeWithToast}
                onerror={closeWithErrorToast} 
            ></c-add-product-modal>
        </div>
    </template>
</template>